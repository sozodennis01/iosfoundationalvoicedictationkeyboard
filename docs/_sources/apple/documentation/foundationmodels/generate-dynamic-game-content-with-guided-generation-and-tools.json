{"schemaVersion":{"major":0,"minor":3,"patch":0},"identifier":{"url":"doc://com.apple.foundationmodels/documentation/FoundationModels/generate-dynamic-game-content-with-guided-generation-and-tools","interfaceLanguage":"swift"},"variants":[{"paths":["/documentation/foundationmodels/generate-dynamic-game-content-with-guided-generation-and-tools"],"traits":[{"interfaceLanguage":"swift"}]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["/documentation/foundationmodels/generate-dynamic-game-content-with-guided-generation-and-tools"]}],"kind":"article","sampleCodeDownload":{"kind":"sampleDownload","action":{"isActive":true,"overridingTitle":"Download","type":"reference","identifier":"86c65aeb21cc/GenerateDynamicGameContentWithGuidedGenerationAndTools.zip"}},"hierarchy":{"paths":[["doc://com.apple.documentation/documentation/technologies","doc://com.apple.foundationmodels/documentation/FoundationModels"]]},"seeAlsoSections":[{"title":"Tool calling","identifiers":["doc://com.apple.foundationmodels/documentation/FoundationModels/expanding-generation-with-tool-calling","doc://com.apple.foundationmodels/documentation/FoundationModels/Tool"],"anchor":"Tool-calling","generated":true}],"metadata":{"role":"sampleCode","roleHeading":"Sample Code","modules":[{"name":"Foundation Models"}],"platforms":[{"name":"iOS","beta":false,"introducedAt":"26.0"},{"name":"iPadOS","beta":false,"introducedAt":"26.0"},{"beta":false,"introducedAt":"26.0","name":"macOS"},{"name":"Xcode","introducedAt":"26.0","beta":false}],"title":"Generate dynamic game content with guided generation and tools"},"primaryContentSections":[{"kind":"content","content":[{"text":"Overview","type":"heading","anchor":"Overview","level":2},{"type":"paragraph","inlineContent":[{"text":"This sample code project demonstrates the Foundation Models framework and its","type":"text"},{"type":"text","text":" "},{"text":"ability to generate dynamic content for a game. Instead of using the same dialog","type":"text"},{"type":"text","text":" "},{"text":"script for customer encounters, the app dynamically generates dialog so that","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"each time a player talks to a character, they can have a different conversation."}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"overview-game-content-view"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The game combines several framework capabilities — like guided generation and"},{"type":"text","text":" "},{"type":"text","text":"tool calling — to create dynamic, personalized gameplay experiences. You"},{"type":"text","text":" "},{"type":"text","text":"interact with both scripted characters, like the head barista, and procedurally"},{"type":"text","text":" "},{"type":"text","text":"generated customers, each with unique personalities, appearances, and coffee orders."},{"type":"text","text":" "},{"type":"text","text":"As you serve customers, you can engage in conversations, take custom coffee orders,"},{"type":"text","text":" "},{"type":"text","text":"and receive feedback on your brewing skills — all powered by an on-device"},{"type":"text","text":" "},{"type":"text","text":"foundation model."}]},{"name":"Note","style":"note","type":"aside","content":[{"inlineContent":[{"type":"text","text":"This sample code project is associated with WWDC25 sessions 301:"},{"type":"text","text":" "},{"identifier":"https://developer.apple.com/wwdc25/301/","isActive":true,"type":"reference"},{"type":"text","text":"."}],"type":"paragraph"}]},{"level":2,"type":"heading","text":"Generate character dialog","anchor":"Generate-character-dialog"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The sample app generates dialog for characters by using "},{"code":"Character","type":"codeVoice"},{"type":"text","text":" to describe"},{"type":"text","text":" "},{"type":"text","text":"the character, like the barista:"}]},{"type":"codeListing","syntax":"swift","code":["struct Barista: Character {","    let id = UUID()","    let displayName = \"Barista\"","    let firstLine = \"Hey there. Can you get the dream orders?\"","","    let persona = \"\"\"","        Chike is the head barista at Dream Coffee, and loves serving up the perfect cup of coffee ","        to all the dreamers and creatures in the dream realm. Today is a particularly busy day, so ","        Chike is happy to have the help of a new trainee barista named Player.","        \"\"\"","","    let errorResponse = \"Maybe let's stop chatting? We've got coffee to serve.\"","}"]},{"inlineContent":[{"type":"text","text":"A "},{"code":"persona","type":"codeVoice"},{"text":" is a detailed description of the character that the model should","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"pretend to be. The app uses a fixed error response when it encounters a"},{"type":"text","text":" "},{"text":"generation error or content that the system blocks for safety.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"DialogEngine"},{"text":" class manages conoversations for all characters in the","type":"text"},{"text":" ","type":"text"},{"text":"game using ","type":"text"},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession","isActive":true},{"type":"text","text":". Each character maintains their own"},{"text":" ","type":"text"},{"type":"text","text":"conversation session, allowing for persistent, contextual dialog that remembers"},{"text":" ","type":"text"},{"text":"previous interactions. When a conversation begins with a character, the dialog","type":"text"},{"type":"text","text":" "},{"type":"text","text":"engine creates a new session with specific instructions that define the"},{"text":" ","type":"text"},{"text":"character’s personality and role:","type":"text"}]},{"syntax":"swift","code":["let instructions = \"\"\"","    A multiturn conversation between a game character and the player of this game. \\","    You are \\(character.displayName). Refer to \\(character.displayName) in the first-person \\","    (like \"I\" or \"me\"). You must respond in the voice of \\(character.persona).\\","","    Keep your responses short and positive. Remember: Because this is the dream realm, \\","    everything is free at this coffee shop and the baristas are paid in creative inpiration.","","    You just said: \"\\(startWith)\"","    \"\"\""],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"When the player provides input text to ","type":"text"},{"inlineContent":[{"text":"talk","type":"text"}],"type":"emphasis"},{"type":"text","text":" to the character, the sample app"},{"type":"text","text":" "},{"type":"text","text":"uses the input as a prompt to the session. When generating a response, the"},{"type":"text","text":" "},{"type":"text","text":"dialog engine includes safety mechanisms to keep conversations on topic. It"},{"type":"text","text":" "},{"type":"text","text":"maintains block lists for words and phrases that characters shouldn’t discuss,"},{"type":"text","text":" "},{"type":"text","text":"ensuring nonplayer characters (NPCs) focus on coffee-related topics. If"},{"type":"text","text":" "},{"text":"the app generates content containing blocked terms, it automatically resets the","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"conversation and provides the default error response for the character."}]},{"code":["let response = try await session.respond(","    to: userInput",")","let dialog = response.content","","// Verify whether the input contains any blocked words or phrases.","if textIsOK(dialog) {","    nextUtterance = dialog","    isGenerating = false","} else {","    nextUtterance = character.errorResponse","    isGenerating = false","    resetSession(character, startWith: character.resumeConversationLine)","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"If the output dialog fails the blocked phrases check, the model may break character","type":"text"},{"text":" ","type":"text"},{"text":"or discuss something that’s outside of the game world. To keep the dialog","type":"text"},{"text":" ","type":"text"},{"text":"immersive, set ","type":"text"},{"type":"codeVoice","code":"nextUtterance"},{"text":" to the character’s fixed error response and","type":"text"},{"type":"text","text":" "},{"type":"text","text":"reset the session."}]},{"level":2,"type":"heading","text":"Generate random encounters","anchor":"Generate-random-encounters"},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"EncounterEngine"},{"type":"text","text":" creates unique customer encounters using the "},{"type":"reference","isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable"},{"text":"","type":"text"},{"type":"text","text":" "},{"type":"text","text":"protocol to generate structured content. Each encounter produces an NPC with a"},{"text":" ","type":"text"},{"text":"name, coffee order, and visual description.","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["@Generable","struct NPC: Equatable {","    let name: String","    let coffeeOrder: String","    let picture: GenerableImage","}"]},{"type":"paragraph","inlineContent":[{"text":"The process of generating an NPC uses a ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession"},{"text":" with a prompt","type":"text"},{"text":" ","type":"text"},{"text":"that provide examples of the output format:","type":"text"}]},{"code":["let session = LanguageModelSession {","    \"\"\"","    A conversation between the Player and a helpful assistant. This is a fantasy ","    RPG game that takes place at Dream Coffee, the beloved coffee shop of the ","    dream realm. Your role is to use your imagination to generate fun game characters.","    \"\"\"","}","let prompt = \"\"\"","    Create an NPC customer with a fun personality suitable for the dream realm. Have the customer order","    coffee. Here are some examples to inspire you:","    {name: \"Thimblefoot\", imageDescription: \"A horse with a rainbow mane\",","    coffeeOrder: \"I would like a coffee that's refreshing and sweet like grass of a summer meadow\"}","    {name: \"Spiderkid\", imageDescription: \"A furry spider with a cool baseball cap\",","    coffeeOrder: \"An iced coffee please, that's as spooky as me!\"}","    {name: \"Wise Fairy\", imageDescription: \"A blue glowing fairy that radiates wisdom and sparkles\",","    coffeeOrder: \"Something simple and plant-based please, that will restore my wise energy.\"}","    \"\"\"","","// Generate the NPC using the custom generable type.","let npc = try await session.respond(","    to: prompt,","    generating: NPC.self,",").content"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"Each generated NPC includes a ","type":"text"},{"code":"GenerableImage","type":"codeVoice"},{"type":"text","text":" that creates a visual representation"},{"text":" ","type":"text"},{"text":"of the character by using ","type":"text"},{"isActive":true,"identifier":"doc://com.apple.documentation/documentation/ImagePlayground","type":"reference"},{"type":"text","text":"."},{"text":" ","type":"text"},{"type":"text","text":"The image generation avoids human-like appearances, focusing instead on"},{"type":"text","text":" "},{"text":"fantastical creatures, animals, and objects that fit the dream realm aesthetic.","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"The "},{"type":"codeVoice","code":"GenerableImage"},{"text":" class shows how to use ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/GenerationSchema"},{"text":" to describe","type":"text"},{"text":" ","type":"text"},{"text":"the properties and guides of the object. This allows for creating dynamic schemas","type":"text"},{"type":"text","text":" "},{"text":"when all of the details of the generable type isn’t known until runtime.","type":"text"}]},{"anchor":"Use-a-language-model-to-judge-in-game-creations","text":"Use a language model to judge in-game creations","type":"heading","level":2},{"inlineContent":[{"text":"The game uses the on-device model to evaluate player performance through the","type":"text"},{"text":" ","type":"text"},{"type":"codeVoice","code":"judgeDrink(drink:)"},{"text":" method in the encounter engine. When the player creates a","type":"text"},{"type":"text","text":" "},{"text":"coffee drink for a customer, the model assumes the customer’s persona and provides","type":"text"},{"type":"text","text":" "},{"text":"feedback on whether the drink matches their original order.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The judging system creates a new "},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession","isActive":true},{"text":" that uses the specific","type":"text"},{"type":"text","text":" "},{"text":"customer’s personality and preferences, and a prompt that provides the drink","type":"text"},{"text":" ","type":"text"},{"text":"details for the model to evaluate:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["let session = LanguageModelSession {","    \"\"\"","    A conversation between a user and a helpful assistant. This is a fantasy RPG ","    game that takes place at Dream Coffee, the beloved coffee shop of the dream ","    realm. Your role is to pretend to be the following customer:","    \\(customer.name): \\(customer.picture.imageDescription)","    \"\"\"","}","let prompt = \"\"\"","    You have just ordered the following drink:","    \\(customer.coffeeOrder)","    The barista has just made you this drink:","    \\(drink)","    Does this drink match your expectations? Do you like it? You must respond ","    with helpful feedback for the barista. If you like your drink, give it a ","    compliment. If you dislike your drink, politely tell the barista why.","    \"\"\"","return try await session.respond(to: prompt).content"]},{"inlineContent":[{"text":"The model then compares the player’s creation against the customer’s original order,","type":"text"},{"text":" ","type":"text"},{"text":"providing contextual feedback that’s authentic to the character’s personality.","type":"text"},{"text":" ","type":"text"},{"text":"This creates a dynamic evaluation system where the same drink might receive","type":"text"},{"text":" ","type":"text"},{"text":"different reactions from different customers based on their unique preferences","type":"text"},{"type":"text","text":" "},{"text":"and personas.","type":"text"}],"type":"paragraph"},{"level":2,"text":"Use tools to personalize game content","anchor":"Use-tools-to-personalize-game-content","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"For customers that the sample generates, provide the dialog engine with custom","type":"text"},{"text":" ","type":"text"},{"text":"tools, like ","type":"text"},{"type":"codeVoice","code":"CalendarTool"},{"type":"text","text":" to create more personalized interactions. This allows"},{"type":"text","text":" "},{"type":"text","text":"characters to reference the player’s on-device information, making conversations"},{"type":"text","text":" "},{"text":"feel more natural and connected to the player’s actual life.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"CalendarTool"},{"type":"text","text":" integrates with "},{"identifier":"doc://com.apple.documentation/documentation/EventKit","type":"reference","isActive":true},{"text":" ","type":"text"},{"text":"to access the player’s calendar events, and allows characters to reference real","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"upcoming events that involve the customer’s name if they are an attendee:"}]},{"syntax":"swift","code":["if let customer = character as? GeneratedCustomer {","    newSession = LanguageModelSession(","        tools: [CalendarTool(contactName: customer.displayName)],","        instructions: instructions","    )","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"The tool description tells the model what it uses the tool for:"}],"type":"paragraph"},{"type":"codeListing","code":["description = \"\"\"","    Get an event from the player's calendar with \\(contactName). \\","    Today is \\(Date().formatted(date: .complete, time: .omitted))","    \"\"\""],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"The sample app also provides a ","type":"text"},{"code":"ContactTool","type":"codeVoice"},{"text":" that accesses the player’s contacts","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"to find names of people born in specific months. This allows the game to generate"},{"type":"text","text":" "},{"text":"a coffee shop customer with names the player is familiar with.","type":"text"}]},{"type":"codeListing","code":["let session = LanguageModelSession(","    tools: [contactsTool],","    instructions: \"\"\"","        Use the \\(contactsTool.name) tool to get a name for a customer.","        \"\"\"",")"],"syntax":"swift"}]}],"sections":[],"abstract":[{"text":"Make gameplay more lively with AI generated dialog and encounters personalized to the player.","type":"text"}],"references":{"https://developer.apple.com/wwdc25/301/":{"type":"link","identifier":"https://developer.apple.com/wwdc25/301/","title":"Deep Dive into the Foundation Models Framework","url":"https://developer.apple.com/wwdc25/301/","titleInlineContent":[{"type":"text","text":"Deep Dive into the Foundation Models Framework"}]},"doc://com.apple.documentation/documentation/EventKit":{"role":"collection","identifier":"doc://com.apple.documentation/documentation/EventKit","abstract":[{"text":"Create, view, and edit calendar and reminder events.","type":"text"}],"title":"EventKit","kind":"symbol","url":"/documentation/EventKit","type":"topic"},"image-playground-PageImage-card.png":{"identifier":"image-playground-PageImage-card.png","type":"image","alt":"An illustration of creating a new image using the image playground UI.","variants":[{"traits":["2x","light"],"url":"https://docs-assets.developer.apple.com/published/951ffef6a939daffb3726161b05a5ca4/image-playground-PageImage-card%402x.png"}]},"overview-game-content-view":{"alt":"At the top-right of the image, a barista at the coffee shop is standing behind","variants":[{"url":"https://docs-assets.developer.apple.com/published/3987b10dbf459c675bc37eae04fb2dfb/overview-game-content-view%402x.png","traits":["2x","light"]},{"traits":["2x","dark"],"url":"https://docs-assets.developer.apple.com/published/9a2166381361de99481e88b050dc6678/overview-game-content-view~dark%402x.png"}],"identifier":"overview-game-content-view","type":"image"},"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool":{"title":"Tool","abstract":[{"text":"A tool that a model can call to gather information at runtime or perform side effects.","type":"text"}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"Tool"}],"url":"/documentation/foundationmodels/tool","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"Tool"}],"kind":"symbol","type":"topic"},"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession":{"kind":"symbol","title":"LanguageModelSession","role":"symbol","type":"topic","abstract":[{"text":"An object that represents a session that interacts with a language model.","type":"text"}],"navigatorTitle":[{"text":"LanguageModelSession","kind":"identifier"}],"url":"/documentation/foundationmodels/languagemodelsession","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LanguageModelSession","kind":"identifier"}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession"},"86c65aeb21cc/GenerateDynamicGameContentWithGuidedGenerationAndTools.zip":{"url":"https://docs-assets.developer.apple.com/published/86c65aeb21cc/GenerateDynamicGameContentWithGuidedGenerationAndTools.zip","type":"download","identifier":"86c65aeb21cc/GenerateDynamicGameContentWithGuidedGenerationAndTools.zip","checksum":"86c65aeb21ccbc8bc107f3c003a652bbe4edbe7856a734dd48ef8387565024c4e3cd884b3f9fab7d953feab7390495ab382733a7b1668ce90af9a69d3523f910"},"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable":{"role":"symbol","navigatorTitle":[{"kind":"identifier","text":"Generable"}],"title":"Generable","type":"topic","kind":"symbol","abstract":[{"text":"A type that the model uses when responding to prompts.","type":"text"}],"fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"Generable"}],"url":"/documentation/foundationmodels/generable","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable"},"doc://com.apple.foundationmodels/documentation/FoundationModels/expanding-generation-with-tool-calling":{"kind":"article","url":"/documentation/foundationmodels/expanding-generation-with-tool-calling","abstract":[{"type":"text","text":"Build tools that enable the model to perform tasks that are specific to your use case."}],"type":"topic","role":"article","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/expanding-generation-with-tool-calling","title":"Expanding generation with tool calling"},"doc://com.apple.documentation/documentation/ImagePlayground":{"kind":"symbol","identifier":"doc://com.apple.documentation/documentation/ImagePlayground","url":"/documentation/ImagePlayground","abstract":[{"text":"Present a system interface to generate images based on descriptive information.","type":"text"}],"role":"collection","title":"Image Playground","type":"topic","images":[{"identifier":"image-playground-PageImage-card.png","type":"card"}]},"doc://com.apple.foundationmodels/documentation/FoundationModels":{"url":"/documentation/foundationmodels","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels","images":[{"type":"card","identifier":"foundation-models-framework-landing-PageImage-card.png"}],"title":"Foundation Models","role":"collection","type":"topic","kind":"symbol","abstract":[{"type":"text","text":"Perform tasks with the on-device model that specializes in language understanding, structured output, and tool calling."}]},"doc://com.apple.foundationmodels/documentation/FoundationModels/GenerationSchema":{"abstract":[{"type":"text","text":"A type that describes the properties of an object and any guides"},{"type":"text","text":" "},{"type":"text","text":"on their values."}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/GenerationSchema","kind":"symbol","url":"/documentation/foundationmodels/generationschema","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"GenerationSchema","kind":"identifier"}],"type":"topic","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"GenerationSchema"}],"title":"GenerationSchema"},"foundation-models-framework-landing-PageImage-card.png":{"type":"image","identifier":"foundation-models-framework-landing-PageImage-card.png","alt":"An illustration that represents a foundation model.","variants":[{"url":"https://docs-assets.developer.apple.com/published/3b31c20778305122ef5216e67f6a6e33/foundation-models-framework-landing-PageImage-card%402x.png","traits":["2x","light"]},{"url":"https://docs-assets.developer.apple.com/published/f16169705bca6cccc271e074fe6ce38d/foundation-models-framework-landing-PageImage-card~dark%402x.png","traits":["2x","dark"]}]},"doc://com.apple.documentation/documentation/technologies":{"abstract":[{"type":"text","text":""}],"role":"overview","type":"topic","kind":"technologies","identifier":"doc://com.apple.documentation/documentation/technologies","title":"Technologies","url":"/documentation/technologies"}},"variantOverrides":[{"patch":[{"value":"occ","op":"replace","path":"/identifier/interfaceLanguage"},{"path":"/topicSections","value":null,"op":"add"},{"path":"/seeAlsoSections","value":[{"identifiers":[],"generated":true,"anchor":"Tool-calling","title":"Tool calling"}],"op":"replace"}],"traits":[{"interfaceLanguage":"occ"}]}],"legalNotices":{"copyright":"Copyright &copy; 2026 Apple Inc. All rights reserved.","termsOfUse":"https://www.apple.com/legal/internet-services/terms/site.html","privacyPolicy":"https://www.apple.com/privacy/privacy-policy"}}