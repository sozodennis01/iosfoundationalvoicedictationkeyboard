{"hierarchy":{"paths":[["doc://com.apple.documentation/documentation/technologies","doc://com.apple.foundationmodels/documentation/FoundationModels"]]},"abstract":[{"text":"Build tools that enable the model to perform tasks that are specific to your use case.","type":"text"}],"identifier":{"interfaceLanguage":"swift","url":"doc://com.apple.foundationmodels/documentation/FoundationModels/expanding-generation-with-tool-calling"},"seeAlsoSections":[{"anchor":"Tool-calling","title":"Tool calling","identifiers":["doc://com.apple.foundationmodels/documentation/FoundationModels/generate-dynamic-game-content-with-guided-generation-and-tools","doc://com.apple.foundationmodels/documentation/FoundationModels/Tool"],"generated":true}],"sections":[],"schemaVersion":{"major":0,"minor":3,"patch":0},"primaryContentSections":[{"kind":"content","content":[{"anchor":"overview","text":"Overview","level":2,"type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Tools provide a way to extend the functionality of the model for your own use cases.","type":"text"},{"text":" ","type":"text"},{"text":"Tool-calling allows the model to interact with external code you create to fetch","type":"text"},{"type":"text","text":" "},{"type":"text","text":"up-to-date information, ground responses in sources of truth that you provide,"},{"type":"text","text":" "},{"text":"and perform side effects, like turning on dark mode.","type":"text"}]},{"inlineContent":[{"text":"You can create tools that enable the model to:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Query entries from your app’s database and reference them in its answer."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Perform actions within your app, like adjusting the difficulty in a game or making","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"a web request to get additional information."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Integrate with other frameworks, like "},{"identifier":"doc://com.apple.documentation/documentation/Contacts","isActive":true,"type":"reference"},{"type":"text","text":""},{"text":" ","type":"text"},{"text":"or ","type":"text"},{"isActive":true,"identifier":"doc://com.apple.documentation/documentation/HealthKit","type":"reference"},{"type":"text","text":", that use existing"},{"type":"text","text":" "},{"type":"text","text":"privacy and security mechanisms."}],"type":"paragraph"}]}]},{"level":2,"text":"Create a custom tool for your task","anchor":"Create-a-custom-tool-for-your-task","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"When you prompt the model with a question or make a request, the model decides"},{"text":" ","type":"text"},{"type":"text","text":"whether it can provide an answer or if it needs the help of a tool. When the model"},{"type":"text","text":" "},{"type":"text","text":"determines that a tool can help, it calls the tool with additional arguments that the"},{"text":" ","type":"text"},{"type":"text","text":"tool can use. After the tool completes the task, it returns control back to the"},{"text":" ","type":"text"},{"text":"model with information about what the tool did. The model can then use the output","type":"text"},{"type":"text","text":" "},{"type":"text","text":"of the tool when it provides the final response."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Before creating a tool, it’s helpful to understand the pattern the"},{"type":"text","text":" "},{"type":"text","text":"framework follows when using the tool you provide. The framework processes a"},{"type":"text","text":" "},{"type":"text","text":"request in six phases:"}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"You present a list of available tools and their parameters to the model."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"You submit your prompt to the model.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"The model generates arguments to the tool(s) it wants to invoke.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Your tool runs code on behalf of the model, using the model’s generated arguments.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Your tool passes its output back to the model.","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"The model produces a final response to the prompt, based on the tool output."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"A tool conforms to "},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool","isActive":true},{"text":" and contains the arguments that the tool accepts,","type":"text"},{"type":"text","text":" "},{"type":"text","text":"and a method that the model calls when it wants to use the tool. You can call"},{"type":"text","text":" "},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool/call(arguments:)","isActive":true},{"type":"text","text":" concurrently with itself or with other tools. The following"},{"text":" ","type":"text"},{"type":"text","text":"example shows a tool that accepts a search term and a number of recipes to retrieve:"}]},{"syntax":"swift","code":["struct BreadDatabaseTool: Tool {","    let name = \"searchBreadDatabase\"","    let description = \"Searches a local database for bread recipes.\"","","    @Generable","    struct Arguments {","        @Guide(description: \"The type of bread to search for\")","        var searchTerm: String","        @Guide(description: \"The number of recipes to get\", .range(1...6))","        var limit: Int","    }","","    struct Recipe {","        var name: String","        var description: String","        var link: URL","    }","    ","    func call(arguments: Arguments) async throws -> [String] {","        var recipes: [Recipe] = []","        ","        // Put your code here to retrieve a list of recipes from your database.","        ","        let formattedRecipes = recipes.map {","            \"Recipe for '\\($0.name)': \\($0.description) Link: \\($0.link)\"","        }","        return formattedRecipes","    }","}"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"When you provide descriptions to generable properties, you help the model understand the"},{"text":" ","type":"text"},{"text":"semantics of the arguments. Keep descriptions as short as possible because long","type":"text"},{"text":" ","type":"text"},{"text":"descriptions take up context size and can introduce latency. For more information on","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"managing the context window size, see"},{"text":" ","type":"text"},{"type":"reference","identifier":"doc://com.apple.documentation/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window","isActive":true},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"text":"Tools use guided generation for the ","type":"text"},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool/Arguments","isActive":true},{"type":"text","text":" property. For more information about"},{"type":"text","text":" "},{"text":"guided generation, see ","type":"text"},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/generating-swift-data-structures-with-guided-generation","isActive":true},{"type":"text","text":"."}]},{"type":"heading","text":"Provide a session with the tool you create","level":2,"anchor":"Provide-a-session-with-the-tool-you-create"},{"type":"paragraph","inlineContent":[{"type":"text","text":"When you create a session, you can provide a list of tools that are relevant to"},{"type":"text","text":" "},{"type":"text","text":"the task you want to complete. The tools you provide are available for all future"},{"type":"text","text":" "},{"type":"text","text":"interactions with the session. The following example initializes a session with a"},{"text":" ","type":"text"},{"type":"text","text":"tool that the model can call when it determines that it would help satisfy the prompt:"}]},{"code":["let session = LanguageModelSession(","    tools: [BreadDatabaseTool()]",")","","let response = try await session.respond(","    to: \"Find three sourdough bread recipes\"",")"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Tool output can be a string, or a "},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/GeneratedContent","isActive":true},{"text":" object. The model can call","type":"text"},{"text":" ","type":"text"},{"text":"a tool multiple times in parallel to satisfy the request, like when retrieving weather","type":"text"},{"type":"text","text":" "},{"text":"details for several cities:","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["struct WeatherTool: Tool {","  let name = \"getWeather\"","  let description = \"Retrieve the latest weather information for a city\"","","  @Generable","  struct Arguments {","      @Guide(description: \"The city to get weather information for\")","      var city: String","  }","","  struct Forecast: Encodable {","      var city: String","      var temperature: Int","  }","","  func call(arguments: Arguments) async throws -> String {","      // Get a random temperature value. Use `WeatherKit` to get ","      // a temperature for the city.","      let temperature = Int.random(in: 30...100)","      let formattedResult = \"\"\"","          The forecast for '\\(arguments.city)' is '\\(temperature)' \\","          degrees Fahrenheit. ","          \"\"\"","      return formattedResult","  }","}","","// Create a session with default instructions that guide the requests.","let session = LanguageModelSession(","    tools: [WeatherTool()],","    instructions: \"Help the person with getting weather information\"",")","","// Make a request that compares the temperature between several locations.","let response = try await session.respond(","    to: \"Is it hotter in Boston, Wichita, or Pittsburgh?\"",")"]},{"text":"Handle errors thrown by a tool","level":2,"anchor":"Handle-errors-thrown-by-a-tool","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"When an error happens during tool calling, the session throws a ","type":"text"},{"isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/ToolCallError","type":"reference"},{"text":"","type":"text"},{"text":" ","type":"text"},{"text":"with the underlying error and includes the tool that throws the error. This helps","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"you understand the error that happened during the tool call, and any custom error"},{"type":"text","text":" "},{"text":"types that your tool produces. You can throw errors from your tools to escape calls","type":"text"},{"type":"text","text":" "},{"text":"when you detect something is wrong, like when the person using your app doesn’t","type":"text"},{"type":"text","text":" "},{"text":"allow access to the required data or a network call is taking longer than expected.","type":"text"},{"type":"text","text":" "},{"type":"text","text":"Alternatively, your tool can return a string that briefly tells the model what"},{"type":"text","text":" "},{"type":"text","text":"didn’t work, like “Cannot access the database.”"}]},{"code":["do {","    let answer = try await session.respond(\"Find a recipe for tomato soup.\")","} catch let error as LanguageModelSession.ToolCallError {","        ","    // Access the name of the tool, like BreadDatabaseTool.","    print(error.tool.name) ","        ","    // Access an underlying error that your tool throws and check if the tool ","    // encounters a specific condition.","    if case .databaseIsEmpty = error.underlyingError as? SearchBreadDatabaseToolError {","        // Display an error in the UI.","    }","","} catch {","    print(\"Some other error: \\(error)\")","}"],"type":"codeListing","syntax":"swift"},{"level":2,"type":"heading","text":"Inspect the call graph","anchor":"Inspect-the-call-graph"},{"type":"paragraph","inlineContent":[{"text":"A session contains an observable ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/transcript"},{"type":"text","text":" property"},{"type":"text","text":" "},{"type":"text","text":"that allows you to track when, and how many times, the model calls your tools."},{"text":" ","type":"text"},{"text":"A transcript also provides the ability to construct a representation of the call","type":"text"},{"type":"text","text":" "},{"text":"graph for debugging purposes and pairs well with ","type":"text"},{"identifier":"doc://com.apple.documentation/documentation/SwiftUI","type":"reference","isActive":true},{"text":" ","type":"text"},{"type":"text","text":"to visualize session history."}]},{"type":"codeListing","code":["struct MyHistoryView: View {","","    @State","    var session = LanguageModelSession(","        tools: [BreadDatabaseTool()]","    )","    ","    var body: some View {","        List(session.transcript) { entry in","            switch entry {       ","            case .instructions(let instructions):","                // Display the instructions the model uses.","            case .prompt(let prompt):","                // Display the prompt made to the model.","            case .toolCall(let call):","                // Display the call details for a tool, like the tool name and arguments.        ","            case .toolOutput(let output):","                // Display the output that a tool provides back to the model.        ","            case .response(let response):","                // Display the response from the model.","            }","        }.task {","            do {","                try await session.respond(to: \"Find a milk bread recipe.\")","            } catch let error {","                // Handle the error.","            }","        }","    }","    ","}"],"syntax":"swift"}]}],"kind":"article","metadata":{"modules":[{"name":"Foundation Models"}],"role":"article","title":"Expanding generation with tool calling","roleHeading":"Article"},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["/documentation/foundationmodels/expanding-generation-with-tool-calling"]}],"references":{"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool/call(arguments:)":{"fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"call","kind":"identifier"},{"kind":"text","text":"("},{"text":"arguments","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"Self"},{"text":".","kind":"text"},{"preciseIdentifier":"s:16FoundationModels4ToolP9ArgumentsQa","text":"Arguments","kind":"typeIdentifier"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"text":" -> ","kind":"text"},{"text":"Self","kind":"typeIdentifier"},{"text":".","kind":"text"},{"preciseIdentifier":"s:16FoundationModels4ToolP6OutputQa","text":"Output","kind":"typeIdentifier"}],"kind":"symbol","type":"topic","title":"call(arguments:)","required":true,"abstract":[{"text":"A language model will call this method when it wants to leverage this tool.","type":"text"}],"url":"/documentation/foundationmodels/tool/call(arguments:)","role":"symbol","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool/call(arguments:)"},"doc://com.apple.foundationmodels/documentation/FoundationModels/GeneratedContent":{"kind":"symbol","abstract":[{"text":"A type that represents structured, generated content.","type":"text"}],"type":"topic","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"text":"GeneratedContent","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"GeneratedContent"}],"url":"/documentation/foundationmodels/generatedcontent","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/GeneratedContent","title":"GeneratedContent","role":"symbol"},"doc://com.apple.foundationmodels/documentation/FoundationModels":{"url":"/documentation/foundationmodels","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels","images":[{"type":"card","identifier":"foundation-models-framework-landing-PageImage-card.png"}],"title":"Foundation Models","role":"collection","type":"topic","kind":"symbol","abstract":[{"type":"text","text":"Perform tasks with the on-device model that specializes in language understanding, structured output, and tool calling."}]},"doc://com.apple.documentation/documentation/Contacts":{"role":"collection","abstract":[{"type":"text","text":"Access the user’s contacts, and format and localize contact information."}],"type":"topic","identifier":"doc://com.apple.documentation/documentation/Contacts","url":"/documentation/Contacts","title":"Contacts","kind":"symbol"},"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool":{"title":"Tool","abstract":[{"text":"A tool that a model can call to gather information at runtime or perform side effects.","type":"text"}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"Tool"}],"url":"/documentation/foundationmodels/tool","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"Tool"}],"kind":"symbol","type":"topic"},"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/ToolCallError":{"navigatorTitle":[{"text":"ToolCallError","kind":"identifier"}],"title":"LanguageModelSession.ToolCallError","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/ToolCallError","abstract":[{"text":"An error that occurs while a system language model is calling a tool.","type":"text"}],"type":"topic","role":"symbol","url":"/documentation/foundationmodels/languagemodelsession/toolcallerror","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"ToolCallError"}],"kind":"symbol"},"doc://com.apple.documentation/documentation/technologies":{"abstract":[{"type":"text","text":""}],"role":"overview","type":"topic","kind":"technologies","identifier":"doc://com.apple.documentation/documentation/technologies","title":"Technologies","url":"/documentation/technologies"},"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/transcript":{"role":"symbol","title":"transcript","kind":"symbol","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/transcript","url":"/documentation/foundationmodels/languagemodelsession/transcript","abstract":[{"text":"A full history of interactions, including user inputs and model responses.","type":"text"}],"fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"text":"transcript","kind":"identifier"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:16FoundationModels10TranscriptV","text":"Transcript","kind":"typeIdentifier"}],"type":"topic"},"doc://com.apple.foundationmodels/documentation/FoundationModels/generate-dynamic-game-content-with-guided-generation-and-tools":{"kind":"article","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/generate-dynamic-game-content-with-guided-generation-and-tools","title":"Generate dynamic game content with guided generation and tools","type":"topic","url":"/documentation/foundationmodels/generate-dynamic-game-content-with-guided-generation-and-tools","abstract":[{"type":"text","text":"Make gameplay more lively with AI generated dialog and encounters personalized to the player."}],"role":"sampleCode"},"doc://com.apple.documentation/documentation/HealthKit":{"role":"collection","url":"/documentation/HealthKit","title":"HealthKit","abstract":[{"type":"text","text":"Access and share health and fitness data while maintaining the user’s privacy and control."}],"identifier":"doc://com.apple.documentation/documentation/HealthKit","type":"topic","kind":"symbol"},"SwiftUI-PageImage-card.png":{"identifier":"SwiftUI-PageImage-card.png","variants":[{"url":"https://docs-assets.developer.apple.com/published/a0ca0e84aabe29cd5bf4d29b4ab5046e/SwiftUI-PageImage-card%402x.png","traits":["2x","light"]},{"traits":["2x","dark"],"url":"https://docs-assets.developer.apple.com/published/a6ddc19a84fa8156d8ec8353a9622d0e/SwiftUI-PageImage-card~dark%402x.png"}],"type":"image","alt":"A stylized Swift logo using dashes on a white or blue background."},"doc://com.apple.documentation/documentation/SwiftUI":{"images":[{"type":"card","identifier":"SwiftUI-PageImage-card.png"}],"role":"collection","url":"/documentation/SwiftUI","kind":"symbol","title":"SwiftUI","abstract":[{"type":"text","text":"Declare the user interface and behavior for your app on every platform."}],"type":"topic","identifier":"doc://com.apple.documentation/documentation/SwiftUI"},"foundation-models-framework-landing-PageImage-card.png":{"alt":"An illustration that represents a foundation model.","variants":[{"url":"https://docs-assets.developer.apple.com/published/3b31c20778305122ef5216e67f6a6e33/foundation-models-framework-landing-PageImage-card%402x.png","traits":["2x","light"]},{"url":"https://docs-assets.developer.apple.com/published/f16169705bca6cccc271e074fe6ce38d/foundation-models-framework-landing-PageImage-card~dark%402x.png","traits":["2x","dark"]}],"identifier":"foundation-models-framework-landing-PageImage-card.png","type":"image"},"doc://com.apple.foundationmodels/documentation/FoundationModels/generating-swift-data-structures-with-guided-generation":{"kind":"article","abstract":[{"type":"text","text":"Create robust apps by describing output you want programmatically."}],"type":"topic","role":"article","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/generating-swift-data-structures-with-guided-generation","title":"Generating Swift data structures with guided generation","url":"/documentation/foundationmodels/generating-swift-data-structures-with-guided-generation"},"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool/Arguments":{"role":"symbol","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Tool/Arguments","url":"/documentation/foundationmodels/tool/arguments","fragments":[{"text":"associatedtype","kind":"keyword"},{"kind":"text","text":" "},{"text":"Arguments","kind":"identifier"},{"kind":"text","text":" : "},{"preciseIdentifier":"s:16FoundationModels31ConvertibleFromGeneratedContentP","text":"ConvertibleFromGeneratedContent","kind":"typeIdentifier"}],"required":true,"abstract":[{"type":"text","text":"The arguments that this tool should accept."}],"type":"topic","kind":"symbol","title":"Arguments"},"doc://com.apple.documentation/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window":{"type":"topic","title":"TN3193: Managing the on-device foundation model’s context window","abstract":[{"text":"Learn how to budget for the context window limit of Apple’s on-device foundation model and handle the error when reaching the limit.","type":"text"}],"url":"/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window","kind":"article","role":"article","identifier":"doc://com.apple.documentation/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window"}},"legalNotices":{"copyright":"Copyright &copy; 2026 Apple Inc. All rights reserved.","termsOfUse":"https://www.apple.com/legal/internet-services/terms/site.html","privacyPolicy":"https://www.apple.com/privacy/privacy-policy"}}