{"variants":[{"paths":["/documentation/foundationmodels/prompting-an-on-device-foundation-model"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"article","schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"title":"Prompting an on-device foundation model","modules":[{"name":"Foundation Models"}],"roleHeading":"Article","role":"article"},"identifier":{"interfaceLanguage":"swift","url":"doc://com.apple.foundationmodels/documentation/FoundationModels/prompting-an-on-device-foundation-model"},"hierarchy":{"paths":[["doc://com.apple.documentation/documentation/technologies","doc://com.apple.foundationmodels/documentation/FoundationModels"]]},"seeAlsoSections":[{"title":"Prompting","identifiers":["doc://com.apple.foundationmodels/documentation/FoundationModels/analyzing-the-runtime-performance-of-your-foundation-models-app","doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession","doc://com.apple.foundationmodels/documentation/FoundationModels/Instructions","doc://com.apple.foundationmodels/documentation/FoundationModels/Prompt","doc://com.apple.foundationmodels/documentation/FoundationModels/Transcript","doc://com.apple.foundationmodels/documentation/FoundationModels/GenerationOptions"],"anchor":"Prompting","generated":true}],"abstract":[{"type":"text","text":"Tailor your prompts to get effective results from an on-device model."}],"sections":[],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Overview","anchor":"overview","level":2},{"inlineContent":[{"type":"text","text":"Many prompting techniques are designed for server-based â€œfrontierâ€ foundation"},{"type":"text","text":" "},{"type":"text","text":"models, because they have a larger context window and thinking capabilities."},{"type":"text","text":" "},{"type":"text","text":"However, when prompting an on-device model, your prompt engineering technique is"},{"type":"text","text":" "},{"type":"text","text":"even more critical because the model you access is much smaller."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"To generate accurate, hallucination-free responses, your prompt needs to be","type":"text"},{"type":"text","text":" "},{"text":"concise and specific. To get a better output from the model, some techniques you","type":"text"},{"text":" ","type":"text"},{"text":"can use include:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Use simple, clear instructions"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Iterate and improve your prompt based on the output you receive in testing"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Provide the model with a reasoning field before answering a prompt"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Reduce the thinking the model needs to do"}]}]},{"content":[{"inlineContent":[{"text":"Split complex prompts into a series of simpler requests","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Add â€œlogicâ€ to conditional prompts with â€œif-elseâ€ statements","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Leverage shot-based prompting â€” such as one-shot, few-shot, or zero-shot","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"prompts â€” to provide the model with specific examples of what you need"}]}]}]},{"inlineContent":[{"text":"Youâ€™ll need to test your prompts throughout development and evaluate the output","type":"text"},{"text":" ","type":"text"},{"text":"to provide a great user experience.","type":"text"}],"type":"paragraph"},{"anchor":"Concepts-for-creating-great-prompts","type":"heading","text":"Concepts for creating great prompts","level":2},{"inlineContent":[{"text":"With prompt engineering, you structure your requests by refining how you phrase","type":"text"},{"text":" ","type":"text"},{"text":"questions, provide context, and format instructions. It also requires testing and","type":"text"},{"type":"text","text":" "},{"text":"iteration of your input to get the results your app needs.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"You can also structure prompts to make the modelâ€™s response depend on specific"},{"text":" ","type":"text"},{"text":"conditions or criteria in the input. For example, instead of giving one fixed","type":"text"},{"text":" ","type":"text"},{"text":"instruction you can include different conditions, like:","type":"text"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"text":"If itâ€™s a question, answer it directly. If itâ€™s a statement, ask a follow-up question.","type":"text"}],"type":"emphasis"}],"type":"paragraph"},{"level":2,"type":"heading","text":"Keep prompts simple and clear","anchor":"Keep-prompts-simple-and-clear"},{"type":"paragraph","inlineContent":[{"text":"Effective prompts use simple language that tells the model what output you want","type":"text"},{"type":"text","text":" "},{"text":"it to provide. The model processes text in units, called ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"tokens","type":"text"}]},{"text":", and each model","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"has a maximum number of tokens it can process â€” the context window size. An"},{"text":" ","type":"text"},{"text":"on-device model has fewer parameters and a small context window, so it doesnâ€™t","type":"text"},{"type":"text","text":" "},{"type":"text","text":"have the resources to handle long or confusing prompts. Input to a frontier"},{"type":"text","text":" "},{"text":"model might be the length of a full document, but your input to the on-device model","type":"text"},{"type":"text","text":" "},{"text":"needs to be short and succinct. Ask yourself whether your prompt is understandable","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"to a human if they read it quickly, and consider additional strategies to adjust"},{"type":"text","text":" "},{"text":"your tone and writing style:","type":"text"}]},{"header":"row","type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"text":"âœ… Prompting strategies to use","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"ðŸš« Prompting strategies to avoid","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Focus on a single, well-defined goal"}]}],[{"type":"paragraph","inlineContent":[{"text":"Combining multiple unrelated requests","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Be direct with imperative verbs like â€œListâ€ or â€œCreateâ€","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Unnecessary politeness or hedging","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Tell the model what role to play, for example, an interior designer","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Passive voice, for example, â€œcode needs to be optimizedâ€","type":"text"}]}]],[[{"inlineContent":[{"text":"Write in direct, conversational tone with simple, clear sentences","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Jargon the model might not understand or interpret incorrectly","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"State your request clearly","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Too short of a prompt that doesnâ€™t outline the task","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Limit your prompt to one to three paragraphs","type":"text"}]}],[{"inlineContent":[{"text":"Too long of a prompt that makes it hard to identify what the task is","type":"text"}],"type":"paragraph"}]]]},{"inlineContent":[{"text":"An on-device model may get confused with a long and indirect instruction because","type":"text"},{"type":"text","text":" "},{"text":"it contains unnecessary language that doesnâ€™t add value. Instead of indirectly","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"implying what the model needs to do, write a direct command to improve the clarity"},{"text":" ","type":"text"},{"text":"of the prompt for better results. This clarity also reduces the complexity and","type":"text"},{"type":"text","text":" "},{"text":"context window size for the on-device model.","type":"text"}],"type":"paragraph"},{"type":"row","columns":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"âœ… "},{"inlineContent":[{"type":"text","text":"Concise and direct"}],"type":"strong"}]},{"inlineContent":[{"type":"emphasis","inlineContent":[{"text":"Given a personâ€™s home-decor transactions and search history, generate three categories they might be interested in, starting with the most relevant category. Generate two more categories related to home-decor but that are not in their transaction or search history.","type":"text"}]}],"type":"paragraph"}],"size":1},{"content":[{"inlineContent":[{"type":"text","text":"ðŸš« "},{"inlineContent":[{"text":"Long and indirect","type":"text"}],"type":"strong"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"The personâ€™s input contains their recent home-decor transaction history along with their recent search history. The response should be a list of existing categories of content the person might be interested relevant to their search and transactions, ordered so that the first categories in the list are most relevant. For inspiration, the response should also include new categories that spark creative ideas that arenâ€™t covered in any of the categories you generate.","type":"text"}],"type":"emphasis"}]}],"size":1}],"numberOfColumns":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"For more information on managing the context window size, see"},{"text":" ","type":"text"},{"identifier":"doc://com.apple.documentation/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window","type":"reference","isActive":true},{"text":".","type":"text"}]},{"text":"Give the model a role, persona, and tone","level":2,"anchor":"Give-the-model-a-role-persona-and-tone","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"By default, the on-device model typically responds to questions in a neutral and","type":"text"},{"text":" ","type":"text"},{"text":"respectful tone, with a business-casual persona. Similar to frontier models, you","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"can provide a role or persona to dramatically change how the on-device model"},{"type":"text","text":" "},{"type":"text","text":"responds to your prompt."}]},{"type":"paragraph","inlineContent":[{"text":"A ","type":"text"},{"inlineContent":[{"type":"text","text":"role"}],"type":"emphasis"},{"text":" is the functional position or job that you instruct the model to assume,","type":"text"},{"type":"text","text":" "},{"type":"text","text":"while a "},{"inlineContent":[{"type":"text","text":"persona"}],"type":"emphasis"},{"type":"text","text":" reflects the personality of the model. You often use both in"},{"text":" ","type":"text"},{"type":"text","text":"prompts; for example:"}]},{"type":"paragraph","inlineContent":[{"type":"emphasis","inlineContent":[{"text":"You are a senior software engineer who values mentoring junior developers.","type":"text"}]}]},{"inlineContent":[{"type":"text","text":"Here the role is â€œa senior software engineer,â€ and the persona is â€œmentoring junior"},{"type":"text","text":" "},{"text":"developers.â€","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The model phrases its response differently to match a persona, for example,"},{"text":" ","type":"text"},{"text":"â€œmentoring junior developersâ€ or â€œevaluating developer codingâ€ even when you","type":"text"},{"text":" ","type":"text"},{"text":"give it the same input for the same task.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"To give the model a role, use the phrase â€œyou areâ€:","type":"text"}],"type":"paragraph"},{"columns":[{"size":1,"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"English Teacher"}]}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"text":"You are an expert English teacher. Provide feedback on the personâ€™s sentence to help them improve clarity.","type":"text"}],"type":"emphasis"}],"type":"paragraph"}]},{"size":1,"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Cowboy"}]}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"You are a lively cowboy who loves to chat about horses and make jokes. Provide feedback on the personâ€™s sentence to help them improve clarity.","type":"text"}],"type":"emphasis"}]}]}],"type":"row","numberOfColumns":2},{"type":"paragraph","inlineContent":[{"text":"Use the phrase â€œexpertâ€ to get the model to speak with more authority and detail","type":"text"},{"text":" ","type":"text"},{"text":"on a topic.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Similarly, change the modelâ€™s behavior by providing a role or persona for the"},{"text":" ","type":"text"},{"text":"person using your app. By default, the on-device model thinks itâ€™s talking to","type":"text"},{"type":"text","text":" "},{"type":"text","text":"a person, so tell the model more about who "},{"type":"emphasis","inlineContent":[{"text":"that","type":"text"}]},{"type":"text","text":" person is:"}]},{"columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Student","type":"text"}],"type":"strong"}]},{"inlineContent":[{"inlineContent":[{"text":"The person is a first-grade English student. Give the person feedback on their writing.","type":"text"}],"type":"emphasis"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Ghost","type":"text"}],"type":"strong"}]},{"type":"paragraph","inlineContent":[{"type":"emphasis","inlineContent":[{"type":"text","text":"Greet a customer who enters your alchemy shop. The customer is a friendly ghost."}]}]}],"size":1}],"type":"row","numberOfColumns":2},{"inlineContent":[{"text":"The student persona causes the model to respond as if speaking to a child in the","type":"text"},{"type":"text","text":" "},{"type":"text","text":"first grade, while the ghost persona causes the model to respond as if speaking"},{"text":" ","type":"text"},{"type":"text","text":"to a ghost in an alchemy shop."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Change the modelâ€™s tone by writing your prompt in a voice you want the model to"},{"type":"text","text":" "},{"text":"match. For example, if you write your prompt in a peppy and cheerful way, or talk","type":"text"},{"type":"text","text":" "},{"type":"text","text":"like a cowboy, the model responds with a matching tone."}],"type":"paragraph"},{"numberOfColumns":2,"type":"row","columns":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Professional","type":"text"}],"type":"strong"}]},{"inlineContent":[{"inlineContent":[{"text":"Communicate as an experienced interior designer consulting with a client. Occasionally reference design elements like harmony, proportion, or focal points.","type":"text"}],"type":"emphasis"}],"type":"paragraph"}],"size":1},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Medieval Scholar"}]}],"type":"paragraph"},{"inlineContent":[{"type":"emphasis","inlineContent":[{"type":"text","text":"Communicate as a learned scribe from a medieval library. Use slightly archaic language (â€œthou shalt,â€ â€œwherein,â€ â€œhenceforthâ€) but keep it readable.â€"}]}],"type":"paragraph"}],"size":1}]},{"level":2,"type":"heading","text":"Iterate and improve instruction following","anchor":"Iterate-and-improve-instruction-following"},{"inlineContent":[{"type":"emphasis","inlineContent":[{"type":"text","text":"Instruction following"}]},{"type":"text","text":" refers to a foundation modelâ€™s ability to carry out a"},{"text":" ","type":"text"},{"type":"text","text":"request exactly as written in your "},{"type":"reference","isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Prompt"},{"type":"text","text":" and "},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Instructions","isActive":true},{"type":"text","text":". Prompt"},{"text":" ","type":"text"},{"type":"text","text":"engineering involves iteration to test and refine input â€” based on the results"},{"text":" ","type":"text"},{"text":"you get â€” to improve accuracy and consistency. If you notice the model isnâ€™t","type":"text"},{"type":"text","text":" "},{"type":"text","text":"following instructions as well as you need, consider the following strategies:"}],"type":"paragraph"},{"header":"row","rows":[[[{"inlineContent":[{"type":"text","text":"Strategy"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Approach","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Improve clarity","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Improve the wording of your input to make it more direct, concise, and easier to read."}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Use emphasis"}]}],[{"type":"paragraph","inlineContent":[{"text":"Emphasize the importance of a command by adding words like â€œmust, â€œshouldâ€, â€œdo notâ€ or avoidâ€.","type":"text"}]}]],[[{"inlineContent":[{"type":"text","text":"Repeat yourself"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Try repeating key instructions at the end of your input to emphasize the importance.","type":"text"}],"type":"paragraph"}]]],"type":"table"},{"inlineContent":[{"type":"text","text":"Instead of trying to enforce accuracy, use a succinct prompt like â€œAnswer this questionâ€"},{"text":" ","type":"text"},{"text":"and evaluate the results you get.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"After you try any strategy, take the time to evaluate it to see if the result"},{"text":" ","type":"text"},{"text":"gets closer to what you need. If the model canâ€™t follow your prompt, it might","type":"text"},{"text":" ","type":"text"},{"text":"be unreliable in some use cases. Try cutting back the number of times you repeat","type":"text"},{"type":"text","text":" "},{"text":"a phrase, or the number of words you emphasize, to make your prompt more effective.","type":"text"},{"text":" ","type":"text"},{"text":"Unreliable prompts break easily when conditions change slightly.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Another prompting strategy is to split your request into a series of simpler"},{"text":" ","type":"text"},{"text":"requests. This is particularly useful after trying different strategies that","type":"text"},{"type":"text","text":" "},{"type":"text","text":"donâ€™t improve the quality of the results."}],"type":"paragraph"},{"text":"Reduce how much thinking the model needs to do","type":"heading","level":2,"anchor":"Reduce-how-much-thinking-the-model-needs-to-do"},{"inlineContent":[{"type":"text","text":"A modelâ€™s reasoning ability is how well it thinks through a problem like a"},{"text":" ","type":"text"},{"text":"human, handles logical puzzles, or creates a logical plan to handle a request.","type":"text"},{"type":"text","text":" "},{"type":"text","text":"Because of their smaller size, on-device models have limited reasoning abilities."},{"text":" ","type":"text"},{"text":"You may be able to help an on-device model ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"think through","type":"text"}]},{"text":" a challenging task by","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"providing additional support for its reasoning."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"For complex tasks, simple language prompts might not have enough detail about"},{"text":" ","type":"text"},{"text":"how the model can accomplish a task. Instead, reduce the reasoning burden on the","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"model by giving it a step-by-step plan. This approach tells the model more"},{"type":"text","text":" "},{"text":"precisely how to do the task:","type":"text"}],"type":"paragraph"},{"columns":[{"content":[{"inlineContent":[{"inlineContent":[{"text":"Step-by-step","type":"text"}],"type":"strong"}],"type":"paragraph"},{"inlineContent":[{"type":"emphasis","inlineContent":[{"type":"text","text":"Given a personâ€™s home-decor transactions and search history related to couches:"}]}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"text":"1. Choose four home furniture categories that are most relevant to this person.","type":"text"}],"type":"emphasis"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"2. Recommend two more categories related to home-decor."}],"type":"emphasis"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"3. Return a list of relevant and recommended categories, ordered by most relevant to least."}],"type":"emphasis"}],"type":"paragraph"}],"size":1}],"numberOfColumns":1,"type":"row"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you find the model isnâ€™t accomplishing the task reliably, break up the steps"},{"type":"text","text":" "},{"type":"text","text":"across multiple "},{"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession","isActive":true},{"type":"text","text":" instances to focus on one part at a time"},{"type":"text","text":" "},{"text":"with a new context window. Typically, itâ€™s a best practice to start with a single","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"request because multiple requests can result in longer inference time. But, if"},{"type":"text","text":" "},{"type":"text","text":"the result doesnâ€™t meet your expectations, try splitting steps into multiple"},{"text":" ","type":"text"},{"type":"text","text":"requests."}]},{"type":"heading","level":2,"text":"Turn conditional prompting into programming logic","anchor":"Turn-conditional-prompting-into-programming-logic"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Conditional"}],"type":"emphasis"},{"type":"text","text":" prompting is where you embed if-else logic into your prompt. A"},{"text":" ","type":"text"},{"type":"text","text":"server-based frontier model has the context window and reasoning abilities to"},{"type":"text","text":" "},{"text":"handle a lengthy list of instructions for how to handle different requests. An","type":"text"},{"type":"text","text":" "},{"type":"text","text":"on-device model can handle some conditionals or light reasoning, like:"}],"type":"paragraph"},{"inlineContent":[{"type":"emphasis","inlineContent":[{"text":"Use the weather tool if the person asks about the weather and the calendar tool","type":"text"},{"type":"text","text":" "},{"text":"if the person asks about events.","type":"text"}]}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"But, too much conditional complexity can affect the on-device modelâ€™s ability to"},{"type":"text","text":" "},{"type":"text","text":"follow instructions."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"When the on-device model output doesnâ€™t meet your expectations, try customizing your"},{"type":"text","text":" "},{"text":"conditional prompt to the current context. For example, the following conditional","type":"text"},{"type":"text","text":" "},{"text":"prompt contains several sentences that break up what the model needs to do:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["let instructions = \"\"\"","    You are a friendly innkeeper. Generate a greeting to a new guest that walks in the door.","    IF the guest is a sorcerer, comment on their magical appearance.","    IF the guest is a bard, ask if they're willing to play music for the inn tonight.","    IF the guest is a soldier, ask if thereâ€™s been any dangerous activity in the area.","    There is one single and one double room available.","    \"\"\""]},{"type":"paragraph","inlineContent":[{"text":"Instead, use programming logic to customize the prompt based on known information:","type":"text"}]},{"type":"codeListing","code":["var customGreeting = \"\"","switch role {","case .bard:","    customGreeting = \"\"\"","        This guest is a bard. Ask if theyâ€™re willing to play music for the inn tonight.","        \"\"\"","case .soldier:","    customGreeting = \"\"\"","        This guest is a soldier. Ask if thereâ€™s been any dangerous activity in the area.","        \"\"\"","case .sorcerer:","    customGreeting = \"\"\"","        This guest is a sorcerer. Comment on their magical appearance.","        \"\"\"","default:","    customGreeting = \"This guest is a weary traveler.\"","}","","let instructions = \"\"\"","    You are a friendly inn keeper. Generate a greeting to a new guest that walks in the door.","    \\(customGreeting)","    There is one single and one double room available.","    \"\"\""],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"When you customize instructions programmatically, the model doesnâ€™t get distracted","type":"text"},{"type":"text","text":" "},{"type":"text","text":"or confused by conditionals that donâ€™t apply in the situation. This approach also"},{"type":"text","text":" "},{"type":"text","text":"reduces the context window size."}]},{"type":"heading","anchor":"Provide-simple-input-output-examples","level":2,"text":"Provide simple input-output examples"},{"type":"paragraph","inlineContent":[{"type":"emphasis","inlineContent":[{"type":"text","text":"Few-shot"}]},{"type":"text","text":" prompting is when you provide the on-device model with a few examples"},{"type":"text","text":" "},{"type":"text","text":"of the output you want. For example, the following shows the model different kinds"},{"type":"text","text":" "},{"text":"of coffee shop customers it needs to generate:","type":"text"}]},{"syntax":"swift","code":["// Instructions that contain JSON key-value pairs that represent the structure","// of a customer. The structure tells the model that each customer must have","// a `name`, `imageDescription`, and `coffeeOrder` fields.","let instructions = \"\"\"","    Create an NPC customer with a fun personality suitable for the dream realm. \\","    Have the customer order coffee. Here are some examples to inspire you:","","    {name: \"Thimblefoot\", imageDescription: \"A horse with a rainbow mane\", \\","    coffeeOrder: \"I would like a coffee that's refreshing and sweet, like the grass in a summer meadow.\"}","    {name: \"Spiderkid\", imageDescription: \"A furry spider with a cool baseball cap\", \\","    coffeeOrder: \"An iced coffee please, that's as spooky as I am!\"}","    {name: \"Wise Fairy\", imageDescription: \"A blue, glowing fairy that radiates wisdom and sparkles\", \\","    coffeeOrder: \"Something simple and plant-based, please. A beverage that restores my wise energy.\"}","    \"\"\""],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Few-shot prompting also works with "},{"type":"emphasis","inlineContent":[{"type":"text","text":"guided generation"}]},{"type":"text","text":", which formats the modelâ€™s"},{"type":"text","text":" "},{"type":"text","text":"output by using a custom type you define. In the previous prompt, each example"},{"type":"text","text":" "},{"text":"might correspond to a ","type":"text"},{"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable","type":"reference","isActive":true},{"type":"text","text":" structure you create named "},{"type":"codeVoice","code":"NPC"},{"type":"text","text":":"}]},{"type":"codeListing","syntax":"swift","code":["@Generable","struct NPC: Equatable {","    let name: String","    let coffeeOrder: String","    let imageDescription: String","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"On-device models need simpler examples for few-shot prompts than what you can use"},{"text":" ","type":"text"},{"text":"with server-based frontier models. Try giving the model between 2-15 examples,","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"and keep each example as simple as possible. If you provide a long or complex"},{"type":"text","text":" "},{"text":"example, the on-device model may start to repeat your example or hallucinate","type":"text"},{"type":"text","text":" "},{"text":"details of your example in its response.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"For more information on guided generation, see ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/generating-swift-data-structures-with-guided-generation"},{"type":"text","text":"."}]},{"level":2,"type":"heading","text":"Handle on-device reasoning","anchor":"Handle-on-device-reasoning"},{"inlineContent":[{"type":"text","text":"Reasoning prompt techniques, like â€œthink through this problem step by stepâ€, can"},{"type":"text","text":" "},{"text":"result in unexpected text being inserted into your ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable"},{"type":"text","text":" structure if"},{"text":" ","type":"text"},{"text":"the model doesnâ€™t have a place for its reasoning. To keep reasoning explanations","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"out of your structure, try giving the model a specific field where it can put"},{"text":" ","type":"text"},{"text":"its reasoning. Make sure the reasoning field is the first property so the model","type":"text"},{"text":" ","type":"text"},{"text":"can provide reasoning details before answering the prompt:","type":"text"}],"type":"paragraph"},{"code":["@Generable","struct ReasonableAnswer {","    // A property the model uses for reasoning.","    var reasoningSteps: String","    ","    @Guide(description: \"The answer only.\")","    var answer: MyCustomGenerableType // Replace with your custom generable type.","}"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Using your custom "},{"isActive":true,"type":"reference","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable"},{"type":"text","text":" type, prompt the model:"}]},{"syntax":"swift","code":["let instructions = \"\"\"","    Answer the person's question.","    1. Begin your response with a plan to solve this question.","    2. Follow your plan's steps and show your work.","    3. Deliver the final answer in `answer`.","    \"\"\"","var session = LanguageModelSession(instructions: instructions)","","// The answer should be 30 days.","let prompt = \"How many days are in the month of September?\"","let response = try await session.respond(","    to: prompt,","    generating: ReasonableAnswer.self",")"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"You may see the model fail to reason its way to a correct answer, or it may"},{"text":" ","type":"text"},{"text":"answer unreliably â€” occasionally answering correctly, and sometimes not. If","type":"text"},{"text":" ","type":"text"},{"text":"this happens, the tasks in your prompt may be too difficult for the on-device","type":"text"},{"text":" ","type":"text"},{"text":"model to process, regardless of how you structure the prompt.","type":"text"}]},{"anchor":"Provide-actionable-feedback","level":2,"type":"heading","text":"Provide actionable feedback"},{"type":"paragraph","inlineContent":[{"text":"When you encounter something with the on-device model that you expect to work","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"but it doesnâ€™t, file a report that includes your prompt with Feedback Assistant"},{"text":" ","type":"text"},{"text":"to help improve the system model. To submit feedback about model behavior through","type":"text"},{"type":"text","text":" "},{"type":"text","text":"Feedback Assistant, see"},{"type":"text","text":" "},{"isActive":true,"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/logFeedbackAttachment(sentiment:issues:desiredOutput:)","type":"reference"},{"type":"text","text":"."}]}]}],"references":{"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession":{"kind":"symbol","title":"LanguageModelSession","role":"symbol","type":"topic","abstract":[{"text":"An object that represents a session that interacts with a language model.","type":"text"}],"navigatorTitle":[{"text":"LanguageModelSession","kind":"identifier"}],"url":"/documentation/foundationmodels/languagemodelsession","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LanguageModelSession","kind":"identifier"}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession"},"doc://com.apple.foundationmodels/documentation/FoundationModels":{"url":"/documentation/foundationmodels","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels","images":[{"type":"card","identifier":"foundation-models-framework-landing-PageImage-card.png"}],"title":"Foundation Models","role":"collection","type":"topic","kind":"symbol","abstract":[{"type":"text","text":"Perform tasks with the on-device model that specializes in language understanding, structured output, and tool calling."}]},"doc://com.apple.foundationmodels/documentation/FoundationModels/GenerationOptions":{"role":"symbol","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/GenerationOptions","abstract":[{"text":"Options that control how the model generates its response to a prompt.","type":"text"}],"url":"/documentation/foundationmodels/generationoptions","fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"kind":"identifier","text":"GenerationOptions"}],"title":"GenerationOptions","kind":"symbol","type":"topic","navigatorTitle":[{"text":"GenerationOptions","kind":"identifier"}]},"doc://com.apple.foundationmodels/documentation/FoundationModels/Instructions":{"type":"topic","role":"symbol","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"Instructions"}],"abstract":[{"type":"text","text":"Details you provide that define the modelâ€™s intended behavior on prompts."}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Instructions","url":"/documentation/foundationmodels/instructions","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"text":"Instructions","kind":"identifier"}],"title":"Instructions"},"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable":{"role":"symbol","navigatorTitle":[{"kind":"identifier","text":"Generable"}],"title":"Generable","type":"topic","kind":"symbol","abstract":[{"text":"A type that the model uses when responding to prompts.","type":"text"}],"fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"Generable"}],"url":"/documentation/foundationmodels/generable","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Generable"},"doc://com.apple.foundationmodels/documentation/FoundationModels/Transcript":{"navigatorTitle":[{"text":"Transcript","kind":"identifier"}],"abstract":[{"type":"text","text":"A linear history of entries that reflect an interaction with a session."}],"kind":"symbol","type":"topic","url":"/documentation/foundationmodels/transcript","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Transcript","title":"Transcript","role":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"text":"Transcript","kind":"identifier"}]},"doc://com.apple.documentation/documentation/technologies":{"abstract":[{"type":"text","text":""}],"role":"overview","type":"topic","kind":"technologies","identifier":"doc://com.apple.documentation/documentation/technologies","title":"Technologies","url":"/documentation/technologies"},"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/logFeedbackAttachment(sentiment:issues:desiredOutput:)":{"url":"/documentation/foundationmodels/languagemodelsession/logfeedbackattachment(sentiment:issues:desiredoutput:)","role":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"logFeedbackAttachment"},{"text":"(","kind":"text"},{"text":"sentiment","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"LanguageModelFeedback","kind":"typeIdentifier","preciseIdentifier":"s:16FoundationModels21LanguageModelFeedbackV"},{"kind":"text","text":"."},{"text":"Sentiment","kind":"typeIdentifier","preciseIdentifier":"s:16FoundationModels21LanguageModelFeedbackV9SentimentO"},{"text":"?, ","kind":"text"},{"text":"issues","kind":"externalParam"},{"text":": [","kind":"text"},{"kind":"typeIdentifier","text":"LanguageModelFeedback","preciseIdentifier":"s:16FoundationModels21LanguageModelFeedbackV"},{"kind":"text","text":"."},{"text":"Issue","kind":"typeIdentifier","preciseIdentifier":"s:16FoundationModels21LanguageModelFeedbackV5IssueV"},{"text":"], ","kind":"text"},{"kind":"externalParam","text":"desiredOutput"},{"kind":"text","text":": "},{"text":"Transcript","kind":"typeIdentifier","preciseIdentifier":"s:16FoundationModels10TranscriptV"},{"kind":"text","text":"."},{"text":"Entry","kind":"typeIdentifier","preciseIdentifier":"s:16FoundationModels10TranscriptV5EntryO"},{"text":"?) -> ","kind":"text"},{"text":"Data","preciseIdentifier":"s:10Foundation4DataV","kind":"typeIdentifier"}],"type":"topic","title":"logFeedbackAttachment(sentiment:issues:desiredOutput:)","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/LanguageModelSession/logFeedbackAttachment(sentiment:issues:desiredOutput:)","abstract":[{"text":"Logs and serializes data that includes session information that you attach when","type":"text"},{"type":"text","text":" "},{"type":"text","text":"reporting feedback to Apple."}],"kind":"symbol"},"doc://com.apple.foundationmodels/documentation/FoundationModels/analyzing-the-runtime-performance-of-your-foundation-models-app":{"title":"Analyzing the runtime performance of your Foundation Models app","type":"topic","url":"/documentation/foundationmodels/analyzing-the-runtime-performance-of-your-foundation-models-app","kind":"article","abstract":[{"text":"Optimize token consumption and improve response times by profiling your appâ€™s model usage with Instruments.","type":"text"}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/analyzing-the-runtime-performance-of-your-foundation-models-app","role":"article"},"doc://com.apple.documentation/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window":{"type":"topic","title":"TN3193: Managing the on-device foundation modelâ€™s context window","abstract":[{"text":"Learn how to budget for the context window limit of Appleâ€™s on-device foundation model and handle the error when reaching the limit.","type":"text"}],"url":"/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window","kind":"article","role":"article","identifier":"doc://com.apple.documentation/documentation/Technotes/tn3193-managing-the-on-device-foundation-model-s-context-window"},"doc://com.apple.foundationmodels/documentation/FoundationModels/generating-swift-data-structures-with-guided-generation":{"kind":"article","abstract":[{"type":"text","text":"Create robust apps by describing output you want programmatically."}],"type":"topic","role":"article","identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/generating-swift-data-structures-with-guided-generation","title":"Generating Swift data structures with guided generation","url":"/documentation/foundationmodels/generating-swift-data-structures-with-guided-generation"},"foundation-models-framework-landing-PageImage-card.png":{"type":"image","identifier":"foundation-models-framework-landing-PageImage-card.png","variants":[{"traits":["2x","light"],"url":"https://docs-assets.developer.apple.com/published/3b31c20778305122ef5216e67f6a6e33/foundation-models-framework-landing-PageImage-card%402x.png"},{"url":"https://docs-assets.developer.apple.com/published/f16169705bca6cccc271e074fe6ce38d/foundation-models-framework-landing-PageImage-card~dark%402x.png","traits":["2x","dark"]}],"alt":"An illustration that represents a foundation model."},"doc://com.apple.foundationmodels/documentation/FoundationModels/Prompt":{"fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"kind":"identifier","text":"Prompt"}],"type":"topic","url":"/documentation/foundationmodels/prompt","abstract":[{"type":"text","text":"A prompt from a person to the model."}],"kind":"symbol","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"Prompt"}],"identifier":"doc://com.apple.foundationmodels/documentation/FoundationModels/Prompt","title":"Prompt"}},"legalNotices":{"copyright":"Copyright &copy; 2026 Apple Inc. All rights reserved.","termsOfUse":"https://www.apple.com/legal/internet-services/terms/site.html","privacyPolicy":"https://www.apple.com/privacy/privacy-policy"}}